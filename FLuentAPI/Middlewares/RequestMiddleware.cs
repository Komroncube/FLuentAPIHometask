namespace FLuentAPI.Middlewares;

public class RequestMiddleware
{
    private readonly RequestDelegate _requestDelegate;
    private readonly ILogger _logger;

    public RequestMiddleware(RequestDelegate requestDelegate, ILogger<RequestMiddleware> logger)
    {
        _requestDelegate = requestDelegate;
        _logger = logger;
    }

    public async Task InvokeAsync(HttpContext context)
    {
        _logger.LogInformation("handling started");

        await _requestDelegate(context);
        var path = context.Request.Path;
        switch(path)
        {
            case "/home":
                await context.Response.WriteAsync("Welcome to homepage");
                break;
            case "/about":
                await context.Response.WriteAsync("This is about page");
                break;
            case "/resume":
                await context.Response.WriteAsync("<!-- Free to use, HTML email template designed & built by FullSphere. Learn more about us at www.fullsphere.co.uk -->\r\n\r\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional //EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\r\n\r\n<head>\r\n\r\n  <!--[if gte mso 9]>\r\n  <xml>\r\n    <o:OfficeDocumentSettings>\r\n      <o:AllowPNG/>\r\n      <o:PixelsPerInch>96</o:PixelsPerInch>\r\n    </o:OfficeDocumentSettings>\r\n  </xml>\r\n  <![endif]-->\r\n\r\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <meta name=\"x-apple-disable-message-reformatting\">\r\n  <!--[if !mso]><!--><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"><!--<![endif]-->\r\n\r\n    <!-- Your title goes here -->\r\n    <title>Newsletter</title>\r\n    <!-- End title -->\r\n\r\n    <!-- Start stylesheet -->\r\n    <style type=\"text/css\">\r\n      a,a[href],a:hover, a:link, a:visited {\r\n        /* This is the link colour */\r\n        text-decoration: none!important;\r\n        color: #0000EE;\r\n      }\r\n      .link {\r\n        text-decoration: underline!important;\r\n      }\r\n      p, p:visited {\r\n        /* Fallback paragraph style */\r\n        font-size:15px;\r\n        line-height:24px;\r\n        font-family:'Helvetica', Arial, sans-serif;\r\n        font-weight:300;\r\n        text-decoration:none;\r\n        color: #000000;\r\n      }\r\n      h1 {\r\n        /* Fallback heading style */\r\n        font-size:22px;\r\n        line-height:24px;\r\n        font-family:'Helvetica', Arial, sans-serif;\r\n        font-weight:normal;\r\n        text-decoration:none;\r\n        color: #000000;\r\n      }\r\n      .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td {line-height: 100%;}\r\n      .ExternalClass {width: 100%;}\r\n    </style>\r\n    <!-- End stylesheet -->\r\n\r\n</head>\r\n\r\n  <!-- You can change background colour here -->\r\n  <body style=\"text-align: center; margin: 0; padding-top: 10px; padding-bottom: 10px; padding-left: 0; padding-right: 0; -webkit-text-size-adjust: 100%;background-color: #f2f4f6; color: #000000\" align=\"center\">\r\n  \r\n  <!-- Fallback force center content -->\r\n  <div style=\"text-align: center;\">\r\n\r\n    <!-- Email not displaying correctly -->\r\n    <table align=\"center\" style=\"text-align: center; vertical-align: middle; width: 600px; max-width: 600px;\" width=\"600\">\r\n      <tbody>\r\n        <tr>\r\n          <td style=\"width: 596px; vertical-align: middle;\" width=\"596\">\r\n\r\n            <p style=\"font-size: 11px; line-height: 20px; font-family: 'Helvetica', Arial, sans-serif; font-weight: 400; text-decoration: none; color: #000000;\">Is this email not displaying correctly? <a class=\"link\" style=\"text-decoration: underline;\" target=\"_blank\" href=\"https://fullsphere.co.uk/html-emails/free-template/\"><u>Click here</u></a> to view in browser</p>\r\n\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    <!-- Email not displaying correctly -->\r\n    \r\n    <!-- Start container for logo -->\r\n    <table align=\"center\" style=\"text-align: center; vertical-align: top; width: 600px; max-width: 600px; background-color: #ffffff;\" width=\"600\">\r\n      <tbody>\r\n        <tr>\r\n          <td style=\"width: 596px; vertical-align: top; padding-left: 0; padding-right: 0; padding-top: 15px; padding-bottom: 15px;\" width=\"596\">\r\n\r\n            <!-- Your logo is here -->\r\n            <img style=\"width: 180px; max-width: 180px; height: 85px; max-height: 85px; text-align: center; color: #ffffff;\" alt=\"Logo\" src=\"https://fullsphere.co.uk/misc/free-template/images/logo-white-background.jpg\" align=\"center\" width=\"180\" height=\"85\">\r\n\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    <!-- End container for logo -->\r\n\r\n    <!-- Hero image -->\r\n    <img style=\"width: 600px; max-width: 600px; height: 350px; max-height: 350px; text-align: center;\" alt=\"Hero image\" src=\"https://fullsphere.co.uk/misc/free-template/images/hero.jpg\" align=\"center\" width=\"600\" height=\"350\">\r\n    <!-- Hero image -->\r\n\r\n    <!-- Start single column section -->\r\n    <table align=\"center\" style=\"text-align: center; vertical-align: top; width: 600px; max-width: 600px; background-color: #ffffff;\" width=\"600\">\r\n        <tbody>\r\n          <tr>\r\n            <td style=\"width: 596px; vertical-align: top; padding-left: 30px; padding-right: 30px; padding-top: 30px; padding-bottom: 40px;\" width=\"596\">\r\n\r\n              <h1 style=\"font-size: 20px; line-height: 24px; font-family: 'Helvetica', Arial, sans-serif; font-weight: 600; text-decoration: none; color: #000000;\">Single column, dolor sit amet</h1>\r\n\r\n              <p style=\"font-size: 15px; line-height: 24px; font-family: 'Helvetica', Arial, sans-serif; font-weight: 400; text-decoration: none; color: #919293;\">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam mattis ante sed imperdiet euismod. Vivamus fermentum bibendum turpis, et tempor dui. Sed vitae lectus egestas, finibus purus ac, rutrum mauris.</p>              \r\n\r\n              <p style=\"font-size: 15px; line-height: 24px; font-family: 'Helvetica', Arial, sans-serif; font-weight: 400; text-decoration: none; color: #919293;\">You can download this template <a target=\"_blank\" style=\"text-decoration: underline; color: #000000;\" href=\"https://fullsphere.co.uk/misc/free-template/html-email-template.zip\" download=\"HTML Email Template\"><u>here</u></a></p>\r\n\r\n              <!-- Start button (You can change the background colour by the hex code below) -->\r\n              <a href=\"#\" target=\"_blank\" style=\"background-color: #000000; font-size: 15px; line-height: 22px; font-family: 'Helvetica', Arial, sans-serif; font-weight: normal; text-decoration: none; padding: 12px 15px; color: #ffffff; border-radius: 5px; display: inline-block; mso-padding-alt: 0;\">\r\n                  <!--[if mso]>\r\n                  <i style=\"letter-spacing: 25px; mso-font-width: -100%; mso-text-raise: 30pt;\">&nbsp;</i>\r\n                <![endif]-->\r\n\r\n                  <span style=\"mso-text-raise: 15pt; color: #ffffff;\">Learn more</span>\r\n                  <!--[if mso]>\r\n                  <i style=\"letter-spacing: 25px; mso-font-width: -100%;\">&nbsp;</i>\r\n                <![endif]-->\r\n              </a>\r\n              <!-- End button here -->\r\n\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n      <!-- End single column section -->\r\n      \r\n      <!-- Start image -->\r\n      <img style=\"width: 600px; max-width: 600px; height: 240px; max-height: 240px; text-align: center;\" alt=\"Image\" src=\"https://fullsphere.co.uk/misc/free-template/images/image-2.jpg\" align=\"center\" width=\"600\" height=\"240\">\r\n      <!-- End image -->\r\n\r\n      <!-- Start heading for double column section -->\r\n      <table align=\"center\" style=\"text-align: center; vertical-align: top; width: 600px; max-width: 600px; background-color: #ffffff;\" width=\"600\">\r\n        <tbody>\r\n          <tr>\r\n            <td style=\"width: 596px; vertical-align: top; padding-left: 30px; padding-right: 30px; padding-top: 30px; padding-bottom: 0;\" width=\"596\">\r\n\r\n              <h1 style=\"font-size: 20px; line-height: 24px; font-family: 'Helvetica', Arial, sans-serif; font-weight: 600; text-decoration: none; color: #000000; margin-bottom: 0;\">Double column, dolor sit amet</h1>\r\n\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n      <!-- End heading for double column section -->\r\n\r\n      <!-- Start double column section -->\r\n      <table align=\"center\" style=\"text-align: center; vertical-align: top; width: 600px; max-width: 600px; background-color: #ffffff;\" width=\"600\">\r\n        <tbody> \r\n            <tr>      \r\n              <td style=\"width: 252px; vertical-align: top; padding-left: 30px; padding-right: 15px; padding-top: 0; padding-bottom: 30px; text-align: center;\" width=\"252\">\r\n\r\n                <p style=\"font-size: 15px; line-height: 24px; font-family: 'Helvetica', Arial, sans-serif; font-weight: 400; text-decoration: none; color: #919293;\">Vivamus felis velit, iaculis eu eros sed, consequat viverra libero. Aliquam ipsum eros, imperdiet eget fermentum eget, cursus a sapien.</p>\r\n              \r\n              </td>\r\n\r\n              <td style=\"width: 252px; vertical-align: top; padding-left: 15px; padding-right: 30px; padding-top: 0; padding-bottom: 30px; text-align: center;\" width=\"252\">              \r\n                <p style=\"font-size: 15px; line-height: 24px; font-family: 'Helvetica', Arial, sans-serif; font-weight: 400; text-decoration: none; color: #919293;\">Pellentesque mollis bibendum sollicitudin. Aenean tempor eros at risus mollis gravida. Aenean in urna eget elit pretium ultrices eu vitae elit.</p>\r\n\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n      <!-- End double column section -->\r\n\r\n      <!-- Start image -->\r\n      <img style=\"width: 600px; max-width: 600px; height: 240px; max-height: 240px; text-align: center;\" alt=\"Image\" src=\"https://fullsphere.co.uk/misc/free-template/images/image-3.jpg\" align=\"center\" width=\"600\" height=\"240\">\r\n      <!-- End image -->\r\n\r\n      <!-- Start footer -->\r\n      <table align=\"center\" style=\"text-align: center; vertical-align: top; width: 600px; max-width: 600px; background-color: #000000;\" width=\"600\">\r\n        <tbody>\r\n          <tr>\r\n            <td style=\"width: 596px; vertical-align: top; padding-left: 30px; padding-right: 30px; padding-top: 30px; padding-bottom: 30px;\" width=\"596\">\r\n\r\n              <!-- Your inverted logo is here -->\r\n              <img style=\"width: 180px; max-width: 180px; height: 85px; max-height: 85px; text-align: center; color: #ffffff;\" alt=\"Logo\" src=\"https://fullsphere.co.uk/misc/free-template/images/logo-black-background.jpg\" align=\"center\" width=\"180\" height=\"85\">\r\n\r\n              <p style=\"font-size: 13px; line-height: 24px; font-family: 'Helvetica', Arial, sans-serif; font-weight: 400; text-decoration: none; color: #ffffff;\">\r\n                Address line 1, London, L2 4LN\r\n              </p>\r\n\r\n              <p style=\"margin-bottom: 0; font-size: 13px; line-height: 24px; font-family: 'Helvetica', Arial, sans-serif; font-weight: 400; text-decoration: none; color: #ffffff;\">\r\n                <a target=\"_blank\" style=\"text-decoration: underline; color: #ffffff;\" href=\"https://fullsphere.co.uk\">\r\n                  www.fullsphere.co.uk\r\n                </a>\r\n              </p>\r\n\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n      <!-- End footer -->\r\n    \r\n      <!-- Start unsubscribe section -->\r\n      <table align=\"center\" style=\"text-align: center; vertical-align: top; width: 600px; max-width: 600px;\" width=\"600\">\r\n        <tbody>\r\n          <tr>\r\n            <td style=\"width: 596px; vertical-align: top; padding-left: 30px; padding-right: 30px; padding-top: 30px; padding-bottom: 30px;\" width=\"596\">\r\n              \r\n              <p style=\"font-size: 12px; line-height: 12px; font-family: 'Helvetica', Arial, sans-serif; font-weight: normal; text-decoration: none; color: #000000;\">\r\n                Not wanting to receive these emails?\r\n              </p>\r\n\r\n              <p style=\"font-size: 12px; line-height: 12px; font-family: 'Helvetica', Arial, sans-serif; font-weight: normal; text-decoration: none; color: #000000;\">\r\n                You can <a style=\"text-decoration: underline; color: #000000;\" href=\"insert-unsubscribe-link-here\"><u>unsubscribe here</u></a>\r\n              </p>\r\n\r\n              <p style=\"font-size: 12px; line-height: 12px; font-family: 'Helvetica', Arial, sans-serif; font-weight: normal; text-decoration: none; color: #919293; margin-top: 30px;\">\r\n                Email template built by <a style=\"text-decoration: none; color: #919293;\" href=\"https://fullsphere.co.uk\"><u>FullSphere</u></a>\r\n              </p>\r\n\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n      <!-- End unsubscribe section -->\r\n  \r\n  </div>\r\n\r\n  </body>\r\n\r\n</html>");
                break;
            default:
                context.Response.StatusCode = 404;
                break;
        }
        _logger.LogInformation($"{path}  ended");

        //_requestDelegate.Invoke(context);
        //return Task.CompletedTask;

    }
}
